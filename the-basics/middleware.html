<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.51">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <meta name="theme-color" content="#00828e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#00828e"><link rel="stylesheet" href="https://use.typekit.net/ins2wgm.css"><link rel="shortcut icon" href="https://raw.githubusercontent.com/confetti-framework/docs/gh-pages/favicon.ico"><title>Middleware | Confetti</title><meta name="description" content="Confetti is a Go (Golang) web application framework with an expressive, elegant syntax. Confetti combines the elegance of Confetti and the simplicity of Go.">
    <link rel="modulepreload" href="/docs/assets/app.cd0b8009.js"><link rel="modulepreload" href="/docs/assets/middleware.html.8364a2f2.js"><link rel="modulepreload" href="/docs/assets/middleware.html.79a05bf5.js"><link rel="prefetch" href="/docs/assets/index.html.31d933e5.js"><link rel="prefetch" href="/docs/assets/lifecycle.html.50685c53.js"><link rel="prefetch" href="/docs/assets/commands.html.3788f9ac.js"><link rel="prefetch" href="/docs/assets/installation.html.32406f42.js"><link rel="prefetch" href="/docs/assets/meet.html.e944717d.js"><link rel="prefetch" href="/docs/assets/your-first-project.html.ff559353.js"><link rel="prefetch" href="/docs/assets/configuration.html.5bdcbf00.js"><link rel="prefetch" href="/docs/assets/errors.html.8295fc2a.js"><link rel="prefetch" href="/docs/assets/logging.html.8c006b84.js"><link rel="prefetch" href="/docs/assets/requests.html.441f6caf.js"><link rel="prefetch" href="/docs/assets/responses.html.06162f92.js"><link rel="prefetch" href="/docs/assets/routing.html.bcaa900b.js"><link rel="prefetch" href="/docs/assets/validation.html.ff6302cf.js"><link rel="prefetch" href="/docs/assets/404.html.98e87f94.js"><link rel="prefetch" href="/docs/assets/index.html.f8fb5d4c.js"><link rel="prefetch" href="/docs/assets/lifecycle.html.9e7e5dc5.js"><link rel="prefetch" href="/docs/assets/commands.html.0b4d8072.js"><link rel="prefetch" href="/docs/assets/installation.html.d38aa07d.js"><link rel="prefetch" href="/docs/assets/meet.html.cf94c9dc.js"><link rel="prefetch" href="/docs/assets/your-first-project.html.c4ddb184.js"><link rel="prefetch" href="/docs/assets/configuration.html.75259ff3.js"><link rel="prefetch" href="/docs/assets/errors.html.ae15d5a4.js"><link rel="prefetch" href="/docs/assets/logging.html.74cd8eea.js"><link rel="prefetch" href="/docs/assets/requests.html.9be86f9b.js"><link rel="prefetch" href="/docs/assets/responses.html.14cdee6a.js"><link rel="prefetch" href="/docs/assets/routing.html.3f1824f9.js"><link rel="prefetch" href="/docs/assets/validation.html.dace1c05.js"><link rel="prefetch" href="/docs/assets/404.html.5b40c3f7.js">
    <link rel="stylesheet" href="/docs/assets/style.63a1126c.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/docs/" class=""><img class="logo" src="https://avatars1.githubusercontent.com/u/57274804?s=400&amp;u=058242df13e206950c08efd68a540445ce4da17f&amp;v=4" alt="Confetti"><span class="site-name can-hide">Confetti</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a class="external-link" href="https://github.com/confetti-framework/confetti" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://www.patreon.com/confetti_framework" rel="noopener noreferrer" target="_blank" aria-label="Becoming a sponsor"><!--[--><!--]--> Becoming a sponsor <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a class="external-link" href="https://github.com/confetti-framework/confetti" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://www.patreon.com/confetti_framework" rel="noopener noreferrer" target="_blank" aria-label="Becoming a sponsor"><!--[--><!--]--> Becoming a sponsor <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Get Started <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/docs/get-started/meet.html" class="sidebar-item" aria-label="Meet Confetti"><!--[--><!--]--> Meet Confetti <!--[--><!--]--></a><!----></li><li><a href="/docs/get-started/installation.html" class="sidebar-item" aria-label="Installation"><!--[--><!--]--> Installation <!--[--><!--]--></a><!----></li><li><a href="/docs/get-started/your-first-project.html" class="sidebar-item" aria-label="Your First Project"><!--[--><!--]--> Your First Project <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Architecture Concepts <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/docs/architecture-concepts/lifecycle.html" class="sidebar-item" aria-label="Request Lifecycle"><!--[--><!--]--> Request Lifecycle <!--[--><!--]--></a><!----></li><li><a href="/docs/architecture-concepts/container" class="sidebar-item" aria-label="/architecture-concepts/container"><!--[--><!--]--> /architecture-concepts/container <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">The Basics <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/docs/the-basics/configuration.html" class="sidebar-item" aria-label="Configuration"><!--[--><!--]--> Configuration <!--[--><!--]--></a><!----></li><li><a href="/docs/the-basics/routing.html" class="sidebar-item" aria-label="Routing"><!--[--><!--]--> Routing <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/docs/the-basics/middleware.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Middleware"><!--[--><!--]--> Middleware <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/docs/the-basics/middleware.html#introduction" class="router-link-active router-link-exact-active sidebar-item" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/docs/the-basics/middleware.html#creating-a-middleware" class="router-link-active router-link-exact-active sidebar-item" aria-label="Creating a Middleware"><!--[--><!--]--> Creating a Middleware <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/docs/the-basics/middleware.html#basic-middleware-example" class="router-link-active router-link-exact-active sidebar-item" aria-label="Basic Middleware Example"><!--[--><!--]--> Basic Middleware Example <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/docs/the-basics/middleware.html#registering-middleware" class="router-link-active router-link-exact-active sidebar-item" aria-label="Registering Middleware"><!--[--><!--]--> Registering Middleware <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/docs/the-basics/middleware.html#registering-a-middleware-for-a-route" class="router-link-active router-link-exact-active sidebar-item" aria-label="Registering a Middleware for a Route"><!--[--><!--]--> Registering a Middleware for a Route <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/docs/the-basics/middleware.html#handy-middleware-examples" class="router-link-active router-link-exact-active sidebar-item" aria-label="Handy Middleware Examples"><!--[--><!--]--> Handy Middleware Examples <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/docs/the-basics/middleware.html#_1-authentication-middleware" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. Authentication Middleware"><!--[--><!--]--> 1. Authentication Middleware <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/docs/the-basics/middleware.html#_2-request-validation-middleware" class="router-link-active router-link-exact-active sidebar-item" aria-label="2. Request Validation Middleware"><!--[--><!--]--> 2. Request Validation Middleware <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/docs/the-basics/middleware.html#conclusion" class="router-link-active router-link-exact-active sidebar-item" aria-label="Conclusion"><!--[--><!--]--> Conclusion <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/docs/the-basics/requests.html" class="sidebar-item" aria-label="Requests"><!--[--><!--]--> Requests <!--[--><!--]--></a><!----></li><li><a href="/docs/the-basics/responses.html" class="sidebar-item" aria-label="Responses"><!--[--><!--]--> Responses <!--[--><!--]--></a><!----></li><li><a href="/docs/the-basics/validation.html" class="sidebar-item" aria-label="Validation"><!--[--><!--]--> Validation <!--[--><!--]--></a><!----></li><li><a href="/docs/the-basics/errors.html" class="sidebar-item" aria-label="Errors"><!--[--><!--]--> Errors <!--[--><!--]--></a><!----></li><li><a href="/docs/the-basics/logging.html" class="sidebar-item" aria-label="Logging and Error Reporting"><!--[--><!--]--> Logging and Error Reporting <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Digging Deeper <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/docs/digging-deeper/commands.html" class="sidebar-item" aria-label="/digging-deeper/commands"><!--[--><!--]--> /digging-deeper/commands <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="middleware" tabindex="-1"><a class="header-anchor" href="#middleware" aria-hidden="true">#</a> Middleware</h1><h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction" aria-hidden="true">#</a> Introduction</h2><p>Middleware are components that sit between the incoming HTTP request and your controller logic. They allow you to execute code before and/or after a request is handled. This is particularly useful for tasks such as authentication, logging, request modification, and response transformation. In Confetti, middleware helps keep your controller code clean by handling cross-cutting concerns in a centralized manner.</p><h2 id="creating-a-middleware" tabindex="-1"><a class="header-anchor" href="#creating-a-middleware" aria-hidden="true">#</a> Creating a Middleware</h2><p>A middleware in Confetti is typically implemented as a type that provides a <code>Handle</code> method. This method wraps your controller function, allowing you to execute custom logic before and/or after the controller is called.</p><h3 id="basic-middleware-example" tabindex="-1"><a class="header-anchor" href="#basic-middleware-example" aria-hidden="true">#</a> Basic Middleware Example</h3><p>Below is an example of a simple logging middleware that logs the request method and URL before passing control to the next handler:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> middleware

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;log&quot;</span>
	<span class="token string">&quot;net/http&quot;</span>
	<span class="token string">&quot;src/internal/pkg/handler&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// LoggingMiddleware is a simple middleware that logs requests.</span>
<span class="token keyword">type</span> LoggingMiddleware <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// Handle wraps a controller with logging functionality.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>l LoggingMiddleware<span class="token punctuation">)</span> <span class="token function">Handle</span><span class="token punctuation">(</span>next handler<span class="token punctuation">.</span>Controller<span class="token punctuation">)</span> handler<span class="token punctuation">.</span>Controller <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> req <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
		<span class="token comment">// Before: Log the incoming request</span>
		log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Incoming request: %s %s&quot;</span><span class="token punctuation">,</span> req<span class="token punctuation">.</span>Method<span class="token punctuation">,</span> req<span class="token punctuation">.</span>URL<span class="token punctuation">.</span>Path<span class="token punctuation">)</span>
		
		<span class="token comment">// Call the next handler in the chain</span>
		err <span class="token operator">:=</span> <span class="token function">next</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> req<span class="token punctuation">)</span>
		
		<span class="token comment">// After: Optionally log the outcome (if needed)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Error processing request: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		
		<span class="token keyword">return</span> err
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="registering-middleware" tabindex="-1"><a class="header-anchor" href="#registering-middleware" aria-hidden="true">#</a> Registering Middleware</h2><p>Once you’ve created your middleware, you need to register it with your routes. In Confetti, routes are defined with the helper <code>handler.New</code> function. You can append middleware to a route using a method like <code>AppendMiddleware</code>.</p><h3 id="registering-a-middleware-for-a-route" tabindex="-1"><a class="header-anchor" href="#registering-a-middleware-for-a-route" aria-hidden="true">#</a> Registering a Middleware for a Route</h3><p>Below is an example of how to register the <code>LoggingMiddleware</code> with a specific route:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> routes

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;src/internal/pkg/handler&quot;</span>
	<span class="token string">&quot;src/internal/controllers&quot;</span>
	<span class="token string">&quot;src/internal/middleware&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> ApiRoutes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>handler<span class="token punctuation">.</span>Route<span class="token punctuation">{</span>
	handler<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;GET /api/example&quot;</span><span class="token punctuation">,</span> controllers<span class="token punctuation">.</span>ExampleController<span class="token punctuation">)</span><span class="token punctuation">.</span>
		<span class="token function">AppendMiddleware</span><span class="token punctuation">(</span>middleware<span class="token punctuation">.</span>LoggingMiddleware<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In this example, every time the <code>/api/example</code> endpoint is hit, the <code>LoggingMiddleware</code> will execute before the <code>ExampleController</code> is called.</p><h2 id="handy-middleware-examples" tabindex="-1"><a class="header-anchor" href="#handy-middleware-examples" aria-hidden="true">#</a> Handy Middleware Examples</h2><h3 id="_1-authentication-middleware" tabindex="-1"><a class="header-anchor" href="#_1-authentication-middleware" aria-hidden="true">#</a> 1. Authentication Middleware</h3><p>This middleware checks whether the request contains the proper authentication token or permission before allowing it to proceed.</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> middleware

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;net/http&quot;</span>
	<span class="token string">&quot;src/internal/pkg/handler&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// AuthMiddleware checks for the required permission.</span>
<span class="token keyword">type</span> AuthMiddleware <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Permission <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token comment">// Handle wraps a controller with authentication logic.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>a AuthMiddleware<span class="token punctuation">)</span> <span class="token function">Handle</span><span class="token punctuation">(</span>next handler<span class="token punctuation">.</span>Controller<span class="token punctuation">)</span> handler<span class="token punctuation">.</span>Controller <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> req <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
		<span class="token comment">// Perform authentication check (this is just a placeholder).</span>
		<span class="token keyword">if</span> req<span class="token punctuation">.</span>Header<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;Authorization&quot;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> handler<span class="token punctuation">.</span><span class="token function">NewUserError</span><span class="token punctuation">(</span><span class="token string">&quot;Unauthorized: missing token&quot;</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span>StatusUnauthorized<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// Optionally check for specific permissions.</span>
		<span class="token comment">// if !hasPermission(req, a.Permission) { ... }</span>

		<span class="token comment">// Proceed to the next handler if authenticated.</span>
		<span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> req<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-request-validation-middleware" tabindex="-1"><a class="header-anchor" href="#_2-request-validation-middleware" aria-hidden="true">#</a> 2. Request Validation Middleware</h3><p>This middleware validates the incoming request data before it reaches the controller.</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> middleware

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;encoding/json&quot;</span>
	<span class="token string">&quot;net/http&quot;</span>
	<span class="token string">&quot;src/internal/pkg/handler&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// ValidateMiddleware ensures that the request body conforms to expected structure.</span>
<span class="token keyword">type</span> ValidateMiddleware <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// Handle parses and validates the request body.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>v ValidateMiddleware<span class="token punctuation">)</span> <span class="token function">Handle</span><span class="token punctuation">(</span>next handler<span class="token punctuation">.</span>Controller<span class="token punctuation">)</span> handler<span class="token punctuation">.</span>Controller <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> req <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
		<span class="token keyword">var</span> data <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>any
		decoder <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">NewDecoder</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">:=</span> decoder<span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> handler<span class="token punctuation">.</span><span class="token function">NewUserError</span><span class="token punctuation">(</span><span class="token string">&quot;Invalid request payload&quot;</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span>StatusBadRequest<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// You could attach validated data to the request context here.</span>
		<span class="token comment">// For simplicity, we proceed to the next handler.</span>
		<span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> req<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="conclusion" tabindex="-1"><a class="header-anchor" href="#conclusion" aria-hidden="true">#</a> Conclusion</h2><p>Middleware in Confetti offers a powerful and flexible way to handle common tasks such as logging, authentication, and validation without cluttering your controller logic. By creating reusable middleware components and registering them with your routes, you can ensure a clean separation of concerns, maintainable code, and a consistent behavior across your application.</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><!----><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: reindertvetter@gmail.com">reindert-vetter</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: reindert@plugandpay.nl">Reindert Vetter</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: vaggelisyfantis@gmail.com">Vaggelis Yfantis</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/docs/the-basics/routing.html" class="" aria-label="Routing"><!--[--><!--]--> Routing <!--[--><!--]--></a></span><span class="next"><a href="/docs/the-basics/requests.html" class="" aria-label="Requests"><!--[--><!--]--> Requests <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/docs/assets/app.cd0b8009.js" defer></script>
  </body>
</html>
